# Console Application Usage Guide

Quick guide for building and using the OnlyOfficeConsoleApp command-line utility for document conversion.
You must have the k8s environment setup ready as explained in the [1.-KUBERNETES_SETUP.md](./1.-KUBERNETES_SETUP.md) guide


## Port forwarding

### Port-Forwards (Teminal 1 and 2)
Run these two commands in SEPARATE terminal windows and keep them running:

Terminal 1:
```powershell
kubectl port-forward -n onlyoffice svc/onlyoffice-onlyoffice-documentserver 8080:80
```

Terminal 2:
```powershell
kubectl port-forward -n onlyoffice svc/onlyoffice-onlyoffice-documentserver-fileserver 9000:9000
```

### Check Port-Forwards (Terminal 3)
Terminal 3: All next commands will be run in this terminal

Then check your port-forwards
```powershell
Get-NetTCPConnection -LocalPort 8080,9000 -ErrorAction SilentlyContinue | Select-Object LocalPort,State
```

should return this:
LocalPort  State
---------  -----
     9000 Listen
     8080 Listen
     9000 Listen
     8080 Listen


## Build and Run console App

Navigate to Project

```powershell
cd c:\WK_SourceCode\POC_OnlyOffice\OnlyOfficeConsoleApp
```

### Build App and Run (Development)

```powershell
# Build in Debug mode
dotnet build .\OnlyOfficeConsoleApp
```
```powershell
# Run directly from source (from root directory)
dotnet run --project .\OnlyOfficeConsoleApp -- .\test_files\input_origin_pdf.pdf
```

### Build App and Run (Release)

```powershell
# Build optimized Release version
dotnet build -c Release
```
```powershell
# Run from compiled binary
.\OnlyOfficeConsoleApp\bin\Release\net8.0\OnlyOfficeConsoleApp.exe .\test_files\input_origin_pdf.pdf
```